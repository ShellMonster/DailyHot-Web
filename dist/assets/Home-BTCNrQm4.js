import{I as e,_ as a,m as t,R as l,f as n}from"./index-D9LGmCWF.js";import{ae as s,r as o,o as r,e as i,b as c,ai as u,ac as d,aj as m,as as p,ag as f,w as h,ab as v,ad as g,z as y,af as w,at as _,c as k,F as b,au as x,am as D,ak as $,ah as A}from"./vue-D_MwEF4M.js";import{f as C,w as j}from"./hotListCache-DqiYTx3r.js";import{S as F,r as I,B as E,m as z,s as B,j as S,k as O,l as R,t as T,o as U,v as L,w as H,x as M}from"./naive-YRcojMnY.js";import"./pinia-fyyCVe93.js";import"./vuedraggable-By4FwDkK.js";const N=e("more",!1,(function(e){return s("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[s("circle",{cx:"12",cy:"24",r:"3",fill:e.colors[0]},null),s("circle",{cx:"24",cy:"24",r:"3",fill:e.colors[0]},null),s("circle",{cx:"36",cy:"24",r:"3",fill:e.colors[0]},null)])})),q=new Map;let P=null;const Z=e=>{const a=o(null);return r((()=>{const t=(P||"undefined"==typeof window||!("IntersectionObserver"in window)||(P=new IntersectionObserver((e=>{e.forEach((e=>{if(!e.isIntersecting)return;const a=q.get(e.target);a&&(a(),P.unobserve(e.target),q.delete(e.target))}))}),{rootMargin:"120px 0px"})),P),l=a.value&&a.value.$el?a.value.$el:a.value;t&&l instanceof Element?(q.set(l,e),t.observe(l)):t||e()})),i((()=>{const e=a.value&&a.value.$el?a.value.$el:a.value;P&&e instanceof Element&&P.unobserve(e);const t=a.value&&a.value.$el?a.value.$el:a.value;q.delete(t)})),a},W=[["#4B7BEC","#45AAF2"],["#F368E0","#C56CF0"],["#26DE81","#20BF6B"],["#FD9644","#F5AF19"],["#A55EEA","#8854D0"],["#FF6B6B","#EE5253"],["#1DD1A1","#10AC84"],["#54A0FF","#2E86DE"],["#F8A5C2","#F78FB3"],["#778CA3","#4B6584"]],G={tech:["github","juejin","linuxdo","hellogithub","ifanr","geekpark","csdn","producthunt"],game:["starrail","lol","52pojie","gameres","genshin","honkai","ngabbs","yystv"],media:["netease-news","sina","sina-news","thepaper","nytimes","weibo","toutiao","huxiu"],community:["v2ex","hostloc","nodeseek","newsmth","douban-group","douban-movie"],life:["weatheralarm","earthquake","smzdm","51cto","coolapk","weread"]},J={tech:0,game:1,media:2,community:3,life:4},K=(e="")=>{const a=(e=>{const a=e.toLowerCase();for(const[t,l]of Object.entries(G))if(l.includes(a))return t;return"default"})(e);if("default"!==a){return W[J[a]??0]}const t=((e="")=>{let a=0;for(let t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t),a|=0;return Math.abs(a)})(e);return W[t%W.length]},Q=a({__name:"AvatarPlaceholder",props:{name:{type:String,default:""},label:{type:String,default:""}},setup(e){const a=e,t=c((()=>((e="",a="")=>{if(e){const a=e.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g,"");if(a.length>=2)return a.slice(0,2).toUpperCase()}const t=a.replace(/[^a-zA-Z0-9]/g,"");return t.length>=2?t.slice(0,2).toUpperCase():(t||"DH").toUpperCase()})(a.label,a.name))),l=c((()=>K(a.name))),n=c((()=>{const[e,a]=l.value;return{background:`linear-gradient(135deg, ${e}, ${a})`}}));return(e,a)=>(d(),u("div",{class:"avatar-placeholder",style:p(n.value)},m(t.value),5))}},[["__scopeId","data-v-8a728558"]]),V={class:"name"},X={key:0,class:"error"},Y={key:1,class:"loading"},ee=["id"],ae={key:0,class:"loading"},te={key:1,class:"message"},le=a({__name:"HotList",props:{hotData:{type:Object,default:{}}},setup(e){const a=f(),j=t(),L=e,H=o(null),M=o("undefined"!=typeof window&&localStorage.getItem(`${L.hotData.name}Btn`)||0),q=o(!1),P="/".replace(/\/+$/,"")||"",W=c((()=>{if(!q.value)return`${P}/logo/${L.hotData.name}.png`})),G=o(null),J=o(null),K=o(!1),le=o(!1);let ne=null;const se=()=>{G.value&&(H.value=n(G.value.updateTime))},oe=async(e,{isNew:a=!1,forceRefresh:t=!1}={})=>{try{le.value=!1;const l=j.newsArr.find((a=>a.name==e));if(!l)return;a&&(K.value=!0);const n=await C({name:l.name,params:l.params,isNew:a,forceRefresh:t});200===n.code?(K.value=!1,G.value=n,se(),J.value&&J.value.scrollTo({position:"top",behavior:"smooth"})):(le.value=!0,$message.error(n.title+n.message))}catch(l){le.value=!0,$message.error("热榜加载失败，请重试")}finally{a&&(K.value=!1)}},re=()=>{const e=Date.now();e-M.value>6e4?(oe(L.hotData.name,{isNew:!0,forceRefresh:!0}),M.value=e,"undefined"!=typeof window&&localStorage.setItem(`${L.hotData.name}Btn`,e)):$message.info("请稍后再刷新")},ie=()=>{L.hotData.name?a.push({path:"/list",query:{type:L.hotData.name}}):$message.error("数据出错，请重试")},ce=Z((()=>{!G.value&&L.hotData.name&&oe(L.hotData.name)})),ue=()=>(q.value=!0,!1);return h((()=>L.hotData.name),((e,a)=>{e&&e!==a&&(q.value=!1,G.value=null,H.value=null,M.value="undefined"!=typeof window&&localStorage.getItem(`${e}Btn`)||0,oe(e))})),r((()=>{se(),ne=setInterval(se,6e4)})),i((()=>{ne&&clearInterval(ne)})),(a,t)=>{const n=T,o=S,r=B,i=O,c=I,f=z,h=E,C=F,L=R,M=U;return d(),v(M,{ref_key:"cardRef",ref:ce,"header-style":{padding:"16px"},"content-style":{padding:"0 16px"},"footer-style":{padding:"16px"},id:`hot-list-${e.hotData.name}`,class:"hot-list",hoverable:"",onClick:ie},{header:g((()=>[s(i,{class:"title",justify:"space-between"},{default:g((()=>[A("div",V,[s(n,{class:"ico",src:w(W),onError:ue},{fallback:g((()=>[s(Q,{name:e.hotData.name,label:e.hotData.label},null,8,["name","label"])])),_:1},8,["src"]),s(o,{class:"name-text"},{default:g((()=>[k(m(e.hotData.label),1)])),_:1})]),w(G)?.type?(d(),v(o,{key:0,class:"subtitle",depth:2},{default:g((()=>[k(m(w(G).type),1)])),_:1})):(d(),v(r,{key:1,width:"60px",text:"",round:""}))])),_:1})])),footer:g((()=>[s(y,{name:"fade",mode:"out-in"},{default:g((()=>[w(G)?(d(),u("div",te,[w(H)?(d(),v(o,{key:0,class:"time",depth:3},{default:g((()=>[k(m(w(H)),1)])),_:1})):(d(),v(o,{key:1,class:"time",depth:3},{default:g((()=>t[2]||(t[2]=[k(" 获取失败 ")]))),_:1})),s(i,{class:"controls"},{default:g((()=>[w(G).data.length>15?(d(),v(L,{key:0},{trigger:g((()=>[s(h,{size:"tiny",secondary:"",strong:"",round:"",onClick:_(ie,["stop"])},{icon:g((()=>[s(f,{component:w(N)},null,8,["component"])])),_:1})])),default:g((()=>[t[3]||(t[3]=k(" 查看更多 "))])),_:1})):$("",!0),s(L,null,{trigger:g((()=>[s(h,{size:"tiny",secondary:"",strong:"",round:"",onClick:_(re,["stop"])},{icon:g((()=>[s(f,{component:w(l)},null,8,["component"])])),_:1})])),default:g((()=>[t[4]||(t[4]=k(" 获取最新 "))])),_:1})])),_:1})])):(d(),u("div",ae,[s(r,{text:"",round:""})]))])),_:1})])),default:g((()=>[s(C,{class:"news-list",ref_key:"scrollbarRef",ref:J},{default:g((()=>[s(y,{name:"fade",mode:"out-in"},{default:g((()=>[w(le)?(d(),u("div",X,[s(c,{size:"small",status:"500",title:"哎呀，加载失败了",description:"生活总会遇到不如意的事情",style:{"margin-top":"40px"}}),s(h,{size:"small",secondary:"",strong:"",round:"",onClick:t[0]||(t[0]=_((a=>oe(e.hotData.name)),["stop"]))},{icon:g((()=>[s(f,{component:w(l)},null,8,["component"])])),default:g((()=>[t[1]||(t[1]=k(" 重试 "))])),_:1})])):!w(G)||w(K)?(d(),u("div",Y,[s(r,{text:"",round:"",repeat:10,height:"20px"})])):(d(),u("div",{key:2,class:"lists",id:e.hotData.name+"Lists"},[(d(!0),u(b,null,x(w(G).data.slice(0,15),((e,a)=>(d(),u("div",{class:"item",key:e},[s(o,{class:D(["num",0===a?"one":1===a?"two":2===a?"three":null]),depth:2},{default:g((()=>[k(m(a+1),1)])),_:2},1032,["class"]),s(o,{style:p({fontSize:w(j).listFontSize+"px"}),class:"text",onClick:_((a=>(e=>{if(!e.url||!e.mobileUrl)return $message.error("链接不存在");const a=window.innerWidth>680?e.url:e.mobileUrl;"open"===j.linkOpenType?window.open(a,"_blank"):"href"===j.linkOpenType&&(window.location.href=a)})(e)),["stop"])},{default:g((()=>[k(m(e.title),1)])),_:2},1032,["style","onClick"])])))),128))],8,ee))])),_:1})])),_:1},512)])),_:1},8,["id"])}}},[["__scopeId","data-v-5b2e6afe"]]),ne={class:"home"},se={key:1,class:"error"},oe=a({__name:"Home",setup(e){const a=t();h((()=>a.newsArr.map((e=>`${e.name}-${e.show}`)).join("|")),(()=>{a.newsArr.length&&a.newsArr.filter((e=>e.show)).slice(0,4).forEach((e=>{j({name:e.name,params:e.params})}))}),{immediate:!0});const l=()=>{$dialog.warning({title:"重置站点",content:"确认重置站点？你的自定义数据将会恢复为默认状态！（当设置页面能正常进入并显示时请不要执行此操作！）",positiveText:"重置",negativeText:"取消",onPositiveClick:()=>{"undefined"!=typeof window&&($timeInterval&&clearInterval($timeInterval),window.localStorage.clear(),window.location.reload())}})};return(e,t)=>{const n=M,o=L,r=H,i=E,c=O;return d(),u("div",ne,[w(a).newsArr[0]&&w(a).newsArr.filter((e=>e.show))[0]?(d(),v(o,{key:0,cols:"1 560:2 800:3 1100:4 1500:5","x-gap":24,"y-gap":24},{default:g((()=>[(d(!0),u(b,null,x(w(a).newsArr.filter((e=>e.show)),((e,a)=>(d(),v(n,{class:"news-card",key:e,style:p({animationDelay:a/10+.2+"s"})},{default:g((()=>[s(le,{hotData:e},null,8,["hotData"])])),_:2},1032,["style"])))),128))])),_:1})):(d(),u("div",se,[s(r,{dashed:"",class:"tip"},{default:g((()=>t[0]||(t[0]=[k(" 此处暂无内容 ")]))),_:1}),s(c,{justify:"center"},{default:g((()=>[s(i,{size:"large",secondary:"",strong:"",onClick:l},{default:g((()=>t[1]||(t[1]=[k(" 出错了？点此重置 ")]))),_:1})])),_:1})]))])}}},[["__scopeId","data-v-f8c81829"]]);export{oe as default};
